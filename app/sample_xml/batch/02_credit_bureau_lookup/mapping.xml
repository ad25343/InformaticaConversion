<?xml version="1.0" encoding="UTF-8"?>
<!--
================================================================================
INFORMATICA POWERCENTER MAPPING EXPORT
================================================================================
Mapping Name: m_LOAN_APP_CREDIT_ENRICHMENT
Pipeline Stage: 2 of 6 (Mortgage Loan E2E Batch Pipeline)
Tier: MEDIUM | Stack: PySpark | Environment: DEV/UAT/PROD

PURPOSE:
--------
This mapping executes Stage 2 of the Mortgage Loan E2E batch pipeline. It enriches
staged loan applications (STG_LOAN_APPLICATIONS) with credit bureau scores via an
unconnected lookup to CREDIT_BUREAU_SCORES (Oracle DB). The enriched data is then
updated into STG_LOAN_APPLICATIONS_ENRICHED with SCD1 semantics (overwrite).

BUSINESS LOGIC:
---------------
1. Source Stage 1 output (STG_LOAN_APPLICATIONS) filtered by load date
2. Derive lookup keys for borrower and co-borrower SSN hashes with bureau code
3. Perform unconnected lookup to CREDIT_BUREAU_SCORES (Oracle) for both borrower/co-borrower
4. Enrich records with credit scores, credit tier classification, and audit columns
5. Apply Update Strategy (SCD1) to update enriched staging table
6. Target enriched data to STG_LOAN_APPLICATIONS_ENRICHED

CREDIT TIER LOGIC:
- EXCELLENT: BUREAU_SCORE >= 750
- GOOD: BUREAU_SCORE >= 670
- FAIR: BUREAU_SCORE >= 580
- POOR: BUREAU_SCORE < 580

TRANSFORMATIONS (6 total):
1. SQ_STG_LOAN_APPLICATIONS (Source Qualifier)
2. EXP_DERIVE_LOOKUP_KEY (Expression for key derivation)
3. LKP_CREDIT_BUREAU_SCORES (Unconnected Lookup)
4. EXP_ENRICH_CREDIT_DATA (Expression for enrichment logic)
5. UPD_SCD1_UPDATE (Update Strategy for SCD1)
6. TGT_STG_LOAN_APPLICATIONS_ENRICHED (Target)

VARIABLES:
- $$SRC_CONNECTION: Snowflake staging connection
- $$TGT_CONNECTION: Snowflake enriched table connection
- $$CREDIT_BUREAU_CONN: Oracle credit bureau connection
- $$LOAD_DATE: ETL run date
- $$ENV: Environment (DEV/UAT/PROD)

Version: 1.0
Created: 2026-03-01
================================================================================
-->

<POWERMART>
  <REPOSITORY>
    <REP_PREOPERTY NAME="REPOSITORY_VERSION" VALUE="10.1.0"/>
    <REP_PREOPERTY NAME="CODEPAGE" VALUE="UTF-8"/>
  </REPOSITORY>
  
  <FOLDER NAME="MORTGAGE_LOAN_E2E" DESCRIPTION="Mortgage Loan End-to-End Batch Pipeline">
    
    <!-- ===== SOURCE DEFINITIONS ===== -->
    <SOURCE NAME="STG_LOAN_APPLICATIONS" 
            SOURCEETYPE="Database" 
            DBDTYPE="Snowflake"
            CONNECTION="$$SRC_CONNECTION"
            SCHEMANAME="STAGING"
            TABLENAME="STG_LOAN_APPLICATIONS"
            DESCRIPTION="Stage 1 output: Staged loan applications awaiting enrichment">
      <SOURCEFIELD NAME="APPLICATION_ID" DATATYPE="Number" PRECISION="18" SCALE="0" NULLABLE="N"/>
      <SOURCEFIELD NAME="BORROWER_SSN_HASH" DATATYPE="String" LENGTH="64" NULLABLE="N"/>
      <SOURCEFIELD NAME="CO_BORROWER_SSN_HASH" DATATYPE="String" LENGTH="64" NULLABLE="Y"/>
      <SOURCEFIELD NAME="LOAN_AMOUNT" DATATYPE="Number" PRECISION="15" SCALE="2" NULLABLE="N"/>
      <SOURCEFIELD NAME="LOAN_PURPOSE" DATATYPE="String" LENGTH="50" NULLABLE="N"/>
      <SOURCEFIELD NAME="LOAN_TYPE" DATATYPE="String" LENGTH="20" NULLABLE="N"/>
      <SOURCEFIELD NAME="INTEREST_RATE" DATATYPE="Number" PRECISION="5" SCALE="3" NULLABLE="N"/>
      <SOURCEFIELD NAME="LOAN_TERM_MONTHS" DATATYPE="Number" PRECISION="5" SCALE="0" NULLABLE="N"/>
      <SOURCEFIELD NAME="DOWN_PAYMENT" DATATYPE="Number" PRECISION="15" SCALE="2" NULLABLE="N"/>
      <SOURCEFIELD NAME="LOAN_TO_VALUE_PCT" DATATYPE="Number" PRECISION="5" SCALE="2" NULLABLE="N"/>
      <SOURCEFIELD NAME="DOWN_PAYMENT_PCT" DATATYPE="Number" PRECISION="5" SCALE="2" NULLABLE="N"/>
      <SOURCEFIELD NAME="OCCUPANCY_TYPE" DATATYPE="String" LENGTH="20" NULLABLE="N"/>
      <SOURCEFIELD NAME="APPLICATION_DATE" DATATYPE="DateTime" NULLABLE="N"/>
      <SOURCEFIELD NAME="LOAN_TYPE_DESC" DATATYPE="String" LENGTH="100" NULLABLE="N"/>
      <SOURCEFIELD NAME="IS_REFI" DATATYPE="String" LENGTH="1" NULLABLE="N"/>
      <SOURCEFIELD NAME="APP_MONTH" DATATYPE="String" LENGTH="7" NULLABLE="N"/>
      <SOURCEFIELD NAME="LOAN_OFFICER_ID" DATATYPE="String" LENGTH="20" NULLABLE="Y"/>
      <SOURCEFIELD NAME="BRANCH_CODE" DATATYPE="String" LENGTH="10" NULLABLE="Y"/>
      <SOURCEFIELD NAME="PROPERTY_STATE" DATATYPE="String" LENGTH="2" NULLABLE="N"/>
      <SOURCEFIELD NAME="STG_LOAD_DATE" DATATYPE="DateTime" NULLABLE="N"/>
    </SOURCE>

    <SOURCE NAME="CREDIT_BUREAU_SCORES" 
            SOURCEETYPE="Database" 
            DBDTYPE="Oracle"
            CONNECTION="$$CREDIT_BUREAU_CONN"
            SCHEMANAME="CREDIT_BUREAU"
            TABLENAME="CREDIT_BUREAU_SCORES"
            DESCRIPTION="Credit bureau lookup table from Oracle: Contains FICO scores and credit attributes">
      <SOURCEFIELD NAME="SSN_HASH" DATATYPE="String" LENGTH="64" NULLABLE="N"/>
      <SOURCEFIELD NAME="BUREAU_SCORE" DATATYPE="Number" PRECISION="4" SCALE="0" NULLABLE="Y"/>
      <SOURCEFIELD NAME="SCORE_DATE" DATATYPE="DateTime" NULLABLE="Y"/>
      <SOURCEFIELD NAME="DEROGATORY_MARKS" DATATYPE="Number" PRECISION="3" SCALE="0" NULLABLE="Y"/>
      <SOURCEFIELD NAME="INQUIRIES_6MO" DATATYPE="Number" PRECISION="3" SCALE="0" NULLABLE="Y"/>
      <SOURCEFIELD NAME="OPEN_ACCOUNTS" DATATYPE="Number" PRECISION="3" SCALE="0" NULLABLE="Y"/>
      <SOURCEFIELD NAME="CREDIT_UTILIZATION_PCT" DATATYPE="Number" PRECISION="5" SCALE="2" NULLABLE="Y"/>
      <SOURCEFIELD NAME="BANKRUPTCY_FLAG" DATATYPE="String" LENGTH="1" NULLABLE="Y"/>
      <SOURCEFIELD NAME="FORECLOSURE_FLAG" DATATYPE="String" LENGTH="1" NULLABLE="Y"/>
      <SOURCEFIELD NAME="BUREAU_CODE" DATATYPE="String" LENGTH="20" NULLABLE="N"/>
    </SOURCE>

    <!-- ===== TARGET DEFINITIONS ===== -->
    <TARGET NAME="STG_LOAN_APPLICATIONS_ENRICHED" 
             TARGETTYPE="Database" 
             DBDTYPE="Snowflake"
             CONNECTION="$$TGT_CONNECTION"
             SCHEMANAME="STAGING"
             TABLENAME="STG_LOAN_APPLICATIONS_ENRICHED"
             DESCRIPTION="Enriched staging table: Loan applications with credit bureau scores and SCD1 history">
      <TARGETFIELD NAME="APPLICATION_ID" DATATYPE="Number" PRECISION="18" SCALE="0" NULLABLE="N" ISKEY="Y"/>
      <TARGETFIELD NAME="BORROWER_SSN_HASH" DATATYPE="String" LENGTH="64" NULLABLE="N"/>
      <TARGETFIELD NAME="CO_BORROWER_SSN_HASH" DATATYPE="String" LENGTH="64" NULLABLE="Y"/>
      <TARGETFIELD NAME="LOAN_AMOUNT" DATATYPE="Number" PRECISION="15" SCALE="2" NULLABLE="N"/>
      <TARGETFIELD NAME="LOAN_PURPOSE" DATATYPE="String" LENGTH="50" NULLABLE="N"/>
      <TARGETFIELD NAME="LOAN_TYPE" DATATYPE="String" LENGTH="20" NULLABLE="N"/>
      <TARGETFIELD NAME="INTEREST_RATE" DATATYPE="Number" PRECISION="5" SCALE="3" NULLABLE="N"/>
      <TARGETFIELD NAME="LOAN_TERM_MONTHS" DATATYPE="Number" PRECISION="5" SCALE="0" NULLABLE="N"/>
      <TARGETFIELD NAME="DOWN_PAYMENT" DATATYPE="Number" PRECISION="15" SCALE="2" NULLABLE="N"/>
      <TARGETFIELD NAME="LOAN_TO_VALUE_PCT" DATATYPE="Number" PRECISION="5" SCALE="2" NULLABLE="N"/>
      <TARGETFIELD NAME="DOWN_PAYMENT_PCT" DATATYPE="Number" PRECISION="5" SCALE="2" NULLABLE="N"/>
      <TARGETFIELD NAME="OCCUPANCY_TYPE" DATATYPE="String" LENGTH="20" NULLABLE="N"/>
      <TARGETFIELD NAME="APPLICATION_DATE" DATATYPE="DateTime" NULLABLE="N"/>
      <TARGETFIELD NAME="LOAN_TYPE_DESC" DATATYPE="String" LENGTH="100" NULLABLE="N"/>
      <TARGETFIELD NAME="IS_REFI" DATATYPE="String" LENGTH="1" NULLABLE="N"/>
      <TARGETFIELD NAME="APP_MONTH" DATATYPE="String" LENGTH="7" NULLABLE="N"/>
      <TARGETFIELD NAME="LOAN_OFFICER_ID" DATATYPE="String" LENGTH="20" NULLABLE="Y"/>
      <TARGETFIELD NAME="BRANCH_CODE" DATATYPE="String" LENGTH="10" NULLABLE="Y"/>
      <TARGETFIELD NAME="PROPERTY_STATE" DATATYPE="String" LENGTH="2" NULLABLE="N"/>
      <TARGETFIELD NAME="STG_LOAD_DATE" DATATYPE="DateTime" NULLABLE="N"/>
      <TARGETFIELD NAME="BUREAU_SCORE" DATATYPE="Number" PRECISION="4" SCALE="0" NULLABLE="Y"/>
      <TARGETFIELD NAME="CREDIT_TIER" DATATYPE="String" LENGTH="20" NULLABLE="Y"/>
      <TARGETFIELD NAME="DEROGATORY_MARKS" DATATYPE="Number" PRECISION="3" SCALE="0" NULLABLE="Y"/>
      <TARGETFIELD NAME="INQUIRIES_6MO" DATATYPE="Number" PRECISION="3" SCALE="0" NULLABLE="Y"/>
      <TARGETFIELD NAME="OPEN_ACCOUNTS" DATATYPE="Number" PRECISION="3" SCALE="0" NULLABLE="Y"/>
      <TARGETFIELD NAME="CREDIT_UTILIZATION_PCT" DATATYPE="Number" PRECISION="5" SCALE="2" NULLABLE="Y"/>
      <TARGETFIELD NAME="BANKRUPTCY_FLAG" DATATYPE="String" LENGTH="1" NULLABLE="Y"/>
      <TARGETFIELD NAME="FORECLOSURE_FLAG" DATATYPE="String" LENGTH="1" NULLABLE="Y"/>
      <TARGETFIELD NAME="BUREAU_CODE" DATATYPE="String" LENGTH="20" NULLABLE="Y"/>
      <TARGETFIELD NAME="SCORE_DATE" DATATYPE="DateTime" NULLABLE="Y"/>
      <TARGETFIELD NAME="ENRICHMENT_DATE" DATATYPE="DateTime" NULLABLE="N"/>
      <TARGETFIELD NAME="EFFECTIVE_DATE" DATATYPE="DateTime" NULLABLE="N"/>
      <TARGETFIELD NAME="EXPIRY_DATE" DATATYPE="DateTime" NULLABLE="N"/>
      <TARGETFIELD NAME="IS_CURRENT" DATATYPE="String" LENGTH="1" NULLABLE="N"/>
    </TARGET>

    <!-- ===== MAPPING DEFINITION ===== -->
    <MAPPING NAME="m_LOAN_APP_CREDIT_ENRICHMENT" 
             DESCRIPTION="Stage 2: Credit Bureau Enrichment with SCD1 Updates"
             MAPPROPERTY_TIER="MEDIUM"
             MAPPROPERTY_STACK="PySpark"
             MAPPROPERTY_STAGE="2 of 6">

      <!-- Transformation 1: Source Qualifier -->
      <TRANSFORMATION NAME="SQ_STG_LOAN_APPLICATIONS"
                       TYPE="Source Qualifier"
                       SOURCENAME="STG_LOAN_APPLICATIONS"
                       DESCRIPTION="Source Qualifier for STG_LOAN_APPLICATIONS with load date filter">
        <TRANSFORMPROPERTY NAME="SQL_QUERY" VALUE="SELECT * FROM STG_LOAN_APPLICATIONS WHERE STG_LOAD_DATE = $$LOAD_DATE"/>
        <TRANSFORMPROPERTY NAME="FILTER_CONDITION" VALUE="STG_LOAD_DATE = $$LOAD_DATE"/>
        <TRANSFORMFIELD NAME="APPLICATION_ID" FIELDTYPE="Output" DATATYPE="Number" PRECISION="18" SCALE="0"/>
        <TRANSFORMFIELD NAME="BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="CO_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="LOAN_AMOUNT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_PURPOSE" FIELDTYPE="Output" DATATYPE="String" LENGTH="50"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="INTEREST_RATE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="3"/>
        <TRANSFORMFIELD NAME="LOAN_TERM_MONTHS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="0"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_TO_VALUE_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="OCCUPANCY_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="APPLICATION_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE_DESC" FIELDTYPE="Output" DATATYPE="String" LENGTH="100"/>
        <TRANSFORMFIELD NAME="IS_REFI" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="APP_MONTH" FIELDTYPE="Output" DATATYPE="String" LENGTH="7"/>
        <TRANSFORMFIELD NAME="LOAN_OFFICER_ID" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="BRANCH_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="10"/>
        <TRANSFORMFIELD NAME="PROPERTY_STATE" FIELDTYPE="Output" DATATYPE="String" LENGTH="2"/>
        <TRANSFORMFIELD NAME="STG_LOAD_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
      </TRANSFORMATION>

      <!-- Transformation 2: Expression for Lookup Key Derivation -->
      <TRANSFORMATION NAME="EXP_DERIVE_LOOKUP_KEY"
                       TYPE="Expression"
                       DESCRIPTION="Derive lookup keys for credit bureau lookup: LOOKUP_KEY for borrower, CO_LOOKUP_KEY for co-borrower">
        <TRANSFORMPROPERTY NAME="EXPRESSION_EDITOR" VALUE="ExpressionLanguage"/>
        <TRANSFORMFIELD NAME="APPLICATION_ID" FIELDTYPE="Input" DATATYPE="Number" PRECISION="18" SCALE="0"/>
        <TRANSFORMFIELD NAME="BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="CO_BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="LOAN_AMOUNT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_PURPOSE" FIELDTYPE="Input" DATATYPE="String" LENGTH="50"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="INTEREST_RATE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="3"/>
        <TRANSFORMFIELD NAME="LOAN_TERM_MONTHS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="0"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_TO_VALUE_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="OCCUPANCY_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="APPLICATION_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE_DESC" FIELDTYPE="Input" DATATYPE="String" LENGTH="100"/>
        <TRANSFORMFIELD NAME="IS_REFI" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="APP_MONTH" FIELDTYPE="Input" DATATYPE="String" LENGTH="7"/>
        <TRANSFORMFIELD NAME="LOAN_OFFICER_ID" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="BRANCH_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="10"/>
        <TRANSFORMFIELD NAME="PROPERTY_STATE" FIELDTYPE="Input" DATATYPE="String" LENGTH="2"/>
        <TRANSFORMFIELD NAME="STG_LOAD_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        
        <!-- Output fields: Pass-through all source fields -->
        <TRANSFORMFIELD NAME="o_APPLICATION_ID" FIELDTYPE="Output" DATATYPE="Number" PRECISION="18" SCALE="0" 
                         EXPRESSION="APPLICATION_ID"/>
        <TRANSFORMFIELD NAME="o_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64" 
                         EXPRESSION="BORROWER_SSN_HASH"/>
        <TRANSFORMFIELD NAME="o_CO_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64" 
                         EXPRESSION="CO_BORROWER_SSN_HASH"/>
        <TRANSFORMFIELD NAME="o_LOAN_AMOUNT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2" 
                         EXPRESSION="LOAN_AMOUNT"/>
        <TRANSFORMFIELD NAME="o_LOAN_PURPOSE" FIELDTYPE="Output" DATATYPE="String" LENGTH="50" 
                         EXPRESSION="LOAN_PURPOSE"/>
        <TRANSFORMFIELD NAME="o_LOAN_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="LOAN_TYPE"/>
        <TRANSFORMFIELD NAME="o_INTEREST_RATE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="3" 
                         EXPRESSION="INTEREST_RATE"/>
        <TRANSFORMFIELD NAME="o_LOAN_TERM_MONTHS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="0" 
                         EXPRESSION="LOAN_TERM_MONTHS"/>
        <TRANSFORMFIELD NAME="o_DOWN_PAYMENT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2" 
                         EXPRESSION="DOWN_PAYMENT"/>
        <TRANSFORMFIELD NAME="o_LOAN_TO_VALUE_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2" 
                         EXPRESSION="LOAN_TO_VALUE_PCT"/>
        <TRANSFORMFIELD NAME="o_DOWN_PAYMENT_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2" 
                         EXPRESSION="DOWN_PAYMENT_PCT"/>
        <TRANSFORMFIELD NAME="o_OCCUPANCY_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="OCCUPANCY_TYPE"/>
        <TRANSFORMFIELD NAME="o_APPLICATION_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="APPLICATION_DATE"/>
        <TRANSFORMFIELD NAME="o_LOAN_TYPE_DESC" FIELDTYPE="Output" DATATYPE="String" LENGTH="100" 
                         EXPRESSION="LOAN_TYPE_DESC"/>
        <TRANSFORMFIELD NAME="o_IS_REFI" FIELDTYPE="Output" DATATYPE="String" LENGTH="1" 
                         EXPRESSION="IS_REFI"/>
        <TRANSFORMFIELD NAME="o_APP_MONTH" FIELDTYPE="Output" DATATYPE="String" LENGTH="7" 
                         EXPRESSION="APP_MONTH"/>
        <TRANSFORMFIELD NAME="o_LOAN_OFFICER_ID" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="LOAN_OFFICER_ID"/>
        <TRANSFORMFIELD NAME="o_BRANCH_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="10" 
                         EXPRESSION="BRANCH_CODE"/>
        <TRANSFORMFIELD NAME="o_PROPERTY_STATE" FIELDTYPE="Output" DATATYPE="String" LENGTH="2" 
                         EXPRESSION="PROPERTY_STATE"/>
        <TRANSFORMFIELD NAME="o_STG_LOAD_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="STG_LOAD_DATE"/>
        
        <!-- Derived lookup keys -->
        <TRANSFORMFIELD NAME="LOOKUP_KEY" FIELDTYPE="Output" DATATYPE="String" LENGTH="256" 
                         EXPRESSION="BORROWER_SSN_HASH || '|' || 'EXPERIAN'"/>
        <TRANSFORMFIELD NAME="CO_LOOKUP_KEY" FIELDTYPE="Output" DATATYPE="String" LENGTH="256" 
                         EXPRESSION="IIF(ISNULL(CO_BORROWER_SSN_HASH), '', CO_BORROWER_SSN_HASH || '|' || 'EXPERIAN')"/>
      </TRANSFORMATION>

      <!-- Transformation 3: Unconnected Lookup -->
      <TRANSFORMATION NAME="LKP_CREDIT_BUREAU_SCORES"
                       TYPE="Unconnected Lookup"
                       LOOKUPTABLE="CREDIT_BUREAU_SCORES"
                       DESCRIPTION="Unconnected lookup to CREDIT_BUREAU_SCORES for credit score retrieval">
        <TRANSFORMPROPERTY NAME="LOOKUP_CONNECTION" VALUE="$$CREDIT_BUREAU_CONN"/>
        <TRANSFORMPROPERTY NAME="LOOKUP_CACHING" VALUE="Static"/>
        <TRANSFORMPROPERTY NAME="LOOKUP_CONDITION" VALUE="SSN_HASH = :LKP.LKP_CREDIT_BUREAU_SCORES(LOOKUP_KEY)"/>
        <TRANSFORMPROPERTY NAME="LOOKUP_SQL_QUERY" VALUE="SELECT SSN_HASH, BUREAU_SCORE, SCORE_DATE, DEROGATORY_MARKS, INQUIRIES_6MO, OPEN_ACCOUNTS, CREDIT_UTILIZATION_PCT, BANKRUPTCY_FLAG, FORECLOSURE_FLAG, BUREAU_CODE FROM CREDIT_BUREAU_SCORES WHERE BUREAU_CODE = 'EXPERIAN'"/>
        
        <!-- Input port -->
        <TRANSFORMFIELD NAME="LOOKUP_KEY" FIELDTYPE="Input" DATATYPE="String" LENGTH="256" ISKEY="Y"/>
        
        <!-- Output ports (return values from lookup) -->
        <TRANSFORMFIELD NAME="BUREAU_SCORE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="4" SCALE="0"/>
        <TRANSFORMFIELD NAME="SCORE_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="DEROGATORY_MARKS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="INQUIRIES_6MO" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="OPEN_ACCOUNTS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="CREDIT_UTILIZATION_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="BANKRUPTCY_FLAG" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="FORECLOSURE_FLAG" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="BUREAU_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
      </TRANSFORMATION>

      <!-- Transformation 4: Expression for Credit Data Enrichment -->
      <TRANSFORMATION NAME="EXP_ENRICH_CREDIT_DATA"
                       TYPE="Expression"
                       DESCRIPTION="Enrich credit data with CREDIT_TIER classification and SCD1 audit columns">
        <TRANSFORMPROPERTY NAME="EXPRESSION_EDITOR" VALUE="ExpressionLanguage"/>
        
        <!-- Input fields: All pass-through fields and lookup results -->
        <TRANSFORMFIELD NAME="APPLICATION_ID" FIELDTYPE="Input" DATATYPE="Number" PRECISION="18" SCALE="0"/>
        <TRANSFORMFIELD NAME="BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="CO_BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="LOAN_AMOUNT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_PURPOSE" FIELDTYPE="Input" DATATYPE="String" LENGTH="50"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="INTEREST_RATE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="3"/>
        <TRANSFORMFIELD NAME="LOAN_TERM_MONTHS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="0"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_TO_VALUE_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="OCCUPANCY_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="APPLICATION_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE_DESC" FIELDTYPE="Input" DATATYPE="String" LENGTH="100"/>
        <TRANSFORMFIELD NAME="IS_REFI" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="APP_MONTH" FIELDTYPE="Input" DATATYPE="String" LENGTH="7"/>
        <TRANSFORMFIELD NAME="LOAN_OFFICER_ID" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="BRANCH_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="10"/>
        <TRANSFORMFIELD NAME="PROPERTY_STATE" FIELDTYPE="Input" DATATYPE="String" LENGTH="2"/>
        <TRANSFORMFIELD NAME="STG_LOAD_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="BUREAU_SCORE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="4" SCALE="0"/>
        <TRANSFORMFIELD NAME="SCORE_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="DEROGATORY_MARKS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="INQUIRIES_6MO" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="OPEN_ACCOUNTS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="CREDIT_UTILIZATION_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="BANKRUPTCY_FLAG" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="FORECLOSURE_FLAG" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="BUREAU_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        
        <!-- Output fields: Pass-through all source and credit fields -->
        <TRANSFORMFIELD NAME="o_APPLICATION_ID" FIELDTYPE="Output" DATATYPE="Number" PRECISION="18" SCALE="0" 
                         EXPRESSION="APPLICATION_ID"/>
        <TRANSFORMFIELD NAME="o_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64" 
                         EXPRESSION="BORROWER_SSN_HASH"/>
        <TRANSFORMFIELD NAME="o_CO_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64" 
                         EXPRESSION="CO_BORROWER_SSN_HASH"/>
        <TRANSFORMFIELD NAME="o_LOAN_AMOUNT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2" 
                         EXPRESSION="LOAN_AMOUNT"/>
        <TRANSFORMFIELD NAME="o_LOAN_PURPOSE" FIELDTYPE="Output" DATATYPE="String" LENGTH="50" 
                         EXPRESSION="LOAN_PURPOSE"/>
        <TRANSFORMFIELD NAME="o_LOAN_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="LOAN_TYPE"/>
        <TRANSFORMFIELD NAME="o_INTEREST_RATE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="3" 
                         EXPRESSION="INTEREST_RATE"/>
        <TRANSFORMFIELD NAME="o_LOAN_TERM_MONTHS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="0" 
                         EXPRESSION="LOAN_TERM_MONTHS"/>
        <TRANSFORMFIELD NAME="o_DOWN_PAYMENT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2" 
                         EXPRESSION="DOWN_PAYMENT"/>
        <TRANSFORMFIELD NAME="o_LOAN_TO_VALUE_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2" 
                         EXPRESSION="LOAN_TO_VALUE_PCT"/>
        <TRANSFORMFIELD NAME="o_DOWN_PAYMENT_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2" 
                         EXPRESSION="DOWN_PAYMENT_PCT"/>
        <TRANSFORMFIELD NAME="o_OCCUPANCY_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="OCCUPANCY_TYPE"/>
        <TRANSFORMFIELD NAME="o_APPLICATION_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="APPLICATION_DATE"/>
        <TRANSFORMFIELD NAME="o_LOAN_TYPE_DESC" FIELDTYPE="Output" DATATYPE="String" LENGTH="100" 
                         EXPRESSION="LOAN_TYPE_DESC"/>
        <TRANSFORMFIELD NAME="o_IS_REFI" FIELDTYPE="Output" DATATYPE="String" LENGTH="1" 
                         EXPRESSION="IS_REFI"/>
        <TRANSFORMFIELD NAME="o_APP_MONTH" FIELDTYPE="Output" DATATYPE="String" LENGTH="7" 
                         EXPRESSION="APP_MONTH"/>
        <TRANSFORMFIELD NAME="o_LOAN_OFFICER_ID" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="LOAN_OFFICER_ID"/>
        <TRANSFORMFIELD NAME="o_BRANCH_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="10" 
                         EXPRESSION="BRANCH_CODE"/>
        <TRANSFORMFIELD NAME="o_PROPERTY_STATE" FIELDTYPE="Output" DATATYPE="String" LENGTH="2" 
                         EXPRESSION="PROPERTY_STATE"/>
        <TRANSFORMFIELD NAME="o_STG_LOAD_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="STG_LOAD_DATE"/>
        <TRANSFORMFIELD NAME="o_BUREAU_SCORE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="4" SCALE="0" 
                         EXPRESSION="BUREAU_SCORE"/>
        <TRANSFORMFIELD NAME="o_SCORE_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="SCORE_DATE"/>
        <TRANSFORMFIELD NAME="o_DEROGATORY_MARKS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0" 
                         EXPRESSION="DEROGATORY_MARKS"/>
        <TRANSFORMFIELD NAME="o_INQUIRIES_6MO" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0" 
                         EXPRESSION="INQUIRIES_6MO"/>
        <TRANSFORMFIELD NAME="o_OPEN_ACCOUNTS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0" 
                         EXPRESSION="OPEN_ACCOUNTS"/>
        <TRANSFORMFIELD NAME="o_CREDIT_UTILIZATION_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2" 
                         EXPRESSION="CREDIT_UTILIZATION_PCT"/>
        <TRANSFORMFIELD NAME="o_BANKRUPTCY_FLAG" FIELDTYPE="Output" DATATYPE="String" LENGTH="1" 
                         EXPRESSION="BANKRUPTCY_FLAG"/>
        <TRANSFORMFIELD NAME="o_FORECLOSURE_FLAG" FIELDTYPE="Output" DATATYPE="String" LENGTH="1" 
                         EXPRESSION="FORECLOSURE_FLAG"/>
        <TRANSFORMFIELD NAME="o_BUREAU_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="BUREAU_CODE"/>
        
        <!-- Derived CREDIT_TIER field -->
        <TRANSFORMFIELD NAME="CREDIT_TIER" FIELDTYPE="Output" DATATYPE="String" LENGTH="20" 
                         EXPRESSION="IIF(ISNULL(BUREAU_SCORE), 'UNKNOWN', IIF(BUREAU_SCORE >= 750, 'EXCELLENT', IIF(BUREAU_SCORE >= 670, 'GOOD', IIF(BUREAU_SCORE >= 580, 'FAIR', 'POOR'))))"/>
        
        <!-- SCD1 audit columns -->
        <TRANSFORMFIELD NAME="ENRICHMENT_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="$$LOAD_DATE"/>
        <TRANSFORMFIELD NAME="EFFECTIVE_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="$$LOAD_DATE"/>
        <TRANSFORMFIELD NAME="EXPIRY_DATE" FIELDTYPE="Output" DATATYPE="DateTime" 
                         EXPRESSION="TO_DATE('9999-12-31', 'YYYY-MM-DD')"/>
        <TRANSFORMFIELD NAME="IS_CURRENT" FIELDTYPE="Output" DATATYPE="String" LENGTH="1" 
                         EXPRESSION="'Y'"/>
      </TRANSFORMATION>

      <!-- Transformation 5: Update Strategy -->
      <TRANSFORMATION NAME="UPD_SCD1_UPDATE"
                       TYPE="Update Strategy"
                       DESCRIPTION="SCD1 Update Strategy: All records update in place (overwrite existing)">
        <TRANSFORMPROPERTY NAME="UPDATE_EXPRESSION" VALUE="DD_UPDATE"/>
        
        <!-- Input ports (pass-through from enrichment expression) -->
        <TRANSFORMFIELD NAME="APPLICATION_ID" FIELDTYPE="Input" DATATYPE="Number" PRECISION="18" SCALE="0" ISKEY="Y"/>
        <TRANSFORMFIELD NAME="BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="CO_BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="LOAN_AMOUNT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_PURPOSE" FIELDTYPE="Input" DATATYPE="String" LENGTH="50"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="INTEREST_RATE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="3"/>
        <TRANSFORMFIELD NAME="LOAN_TERM_MONTHS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="0"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_TO_VALUE_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="OCCUPANCY_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="APPLICATION_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE_DESC" FIELDTYPE="Input" DATATYPE="String" LENGTH="100"/>
        <TRANSFORMFIELD NAME="IS_REFI" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="APP_MONTH" FIELDTYPE="Input" DATATYPE="String" LENGTH="7"/>
        <TRANSFORMFIELD NAME="LOAN_OFFICER_ID" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="BRANCH_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="10"/>
        <TRANSFORMFIELD NAME="PROPERTY_STATE" FIELDTYPE="Input" DATATYPE="String" LENGTH="2"/>
        <TRANSFORMFIELD NAME="STG_LOAD_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="BUREAU_SCORE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="4" SCALE="0"/>
        <TRANSFORMFIELD NAME="CREDIT_TIER" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="DEROGATORY_MARKS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="INQUIRIES_6MO" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="OPEN_ACCOUNTS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="CREDIT_UTILIZATION_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="BANKRUPTCY_FLAG" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="FORECLOSURE_FLAG" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="BUREAU_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="SCORE_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="ENRICHMENT_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="EFFECTIVE_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="EXPIRY_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="IS_CURRENT" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        
        <!-- Output ports (same as input for pass-through with update flag) -->
        <TRANSFORMFIELD NAME="o_APPLICATION_ID" FIELDTYPE="Output" DATATYPE="Number" PRECISION="18" SCALE="0"/>
        <TRANSFORMFIELD NAME="o_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="o_CO_BORROWER_SSN_HASH" FIELDTYPE="Output" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="o_LOAN_AMOUNT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="o_LOAN_PURPOSE" FIELDTYPE="Output" DATATYPE="String" LENGTH="50"/>
        <TRANSFORMFIELD NAME="o_LOAN_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="o_INTEREST_RATE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="3"/>
        <TRANSFORMFIELD NAME="o_LOAN_TERM_MONTHS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="0"/>
        <TRANSFORMFIELD NAME="o_DOWN_PAYMENT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="o_LOAN_TO_VALUE_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="o_DOWN_PAYMENT_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="o_OCCUPANCY_TYPE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="o_APPLICATION_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="o_LOAN_TYPE_DESC" FIELDTYPE="Output" DATATYPE="String" LENGTH="100"/>
        <TRANSFORMFIELD NAME="o_IS_REFI" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="o_APP_MONTH" FIELDTYPE="Output" DATATYPE="String" LENGTH="7"/>
        <TRANSFORMFIELD NAME="o_LOAN_OFFICER_ID" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="o_BRANCH_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="10"/>
        <TRANSFORMFIELD NAME="o_PROPERTY_STATE" FIELDTYPE="Output" DATATYPE="String" LENGTH="2"/>
        <TRANSFORMFIELD NAME="o_STG_LOAD_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="o_BUREAU_SCORE" FIELDTYPE="Output" DATATYPE="Number" PRECISION="4" SCALE="0"/>
        <TRANSFORMFIELD NAME="o_CREDIT_TIER" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="o_DEROGATORY_MARKS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="o_INQUIRIES_6MO" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="o_OPEN_ACCOUNTS" FIELDTYPE="Output" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="o_CREDIT_UTILIZATION_PCT" FIELDTYPE="Output" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="o_BANKRUPTCY_FLAG" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="o_FORECLOSURE_FLAG" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="o_BUREAU_CODE" FIELDTYPE="Output" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="o_SCORE_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="o_ENRICHMENT_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="o_EFFECTIVE_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="o_EXPIRY_DATE" FIELDTYPE="Output" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="o_IS_CURRENT" FIELDTYPE="Output" DATATYPE="String" LENGTH="1"/>
      </TRANSFORMATION>

      <!-- Transformation 6: Target -->
      <TRANSFORMATION NAME="TGT_STG_LOAN_APPLICATIONS_ENRICHED"
                       TYPE="Target"
                       TARGETNAME="STG_LOAN_APPLICATIONS_ENRICHED"
                       DESCRIPTION="Target: Enriched staging table with credit scores and SCD1 history">
        <TRANSFORMPROPERTY NAME="TARGET_LOAD_TYPE" VALUE="Update"/>
        <TRANSFORMPROPERTY NAME="TARGET_CONNECTION" VALUE="$$TGT_CONNECTION"/>
        
        <!-- Target fields mapped from Update Strategy output -->
        <TRANSFORMFIELD NAME="APPLICATION_ID" FIELDTYPE="Input" DATATYPE="Number" PRECISION="18" SCALE="0"/>
        <TRANSFORMFIELD NAME="BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="CO_BORROWER_SSN_HASH" FIELDTYPE="Input" DATATYPE="String" LENGTH="64"/>
        <TRANSFORMFIELD NAME="LOAN_AMOUNT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_PURPOSE" FIELDTYPE="Input" DATATYPE="String" LENGTH="50"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="INTEREST_RATE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="3"/>
        <TRANSFORMFIELD NAME="LOAN_TERM_MONTHS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="0"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="15" SCALE="2"/>
        <TRANSFORMFIELD NAME="LOAN_TO_VALUE_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="DOWN_PAYMENT_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="OCCUPANCY_TYPE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="APPLICATION_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="LOAN_TYPE_DESC" FIELDTYPE="Input" DATATYPE="String" LENGTH="100"/>
        <TRANSFORMFIELD NAME="IS_REFI" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="APP_MONTH" FIELDTYPE="Input" DATATYPE="String" LENGTH="7"/>
        <TRANSFORMFIELD NAME="LOAN_OFFICER_ID" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="BRANCH_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="10"/>
        <TRANSFORMFIELD NAME="PROPERTY_STATE" FIELDTYPE="Input" DATATYPE="String" LENGTH="2"/>
        <TRANSFORMFIELD NAME="STG_LOAD_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="BUREAU_SCORE" FIELDTYPE="Input" DATATYPE="Number" PRECISION="4" SCALE="0"/>
        <TRANSFORMFIELD NAME="CREDIT_TIER" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="DEROGATORY_MARKS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="INQUIRIES_6MO" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="OPEN_ACCOUNTS" FIELDTYPE="Input" DATATYPE="Number" PRECISION="3" SCALE="0"/>
        <TRANSFORMFIELD NAME="CREDIT_UTILIZATION_PCT" FIELDTYPE="Input" DATATYPE="Number" PRECISION="5" SCALE="2"/>
        <TRANSFORMFIELD NAME="BANKRUPTCY_FLAG" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="FORECLOSURE_FLAG" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
        <TRANSFORMFIELD NAME="BUREAU_CODE" FIELDTYPE="Input" DATATYPE="String" LENGTH="20"/>
        <TRANSFORMFIELD NAME="SCORE_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="ENRICHMENT_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="EFFECTIVE_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="EXPIRY_DATE" FIELDTYPE="Input" DATATYPE="DateTime"/>
        <TRANSFORMFIELD NAME="IS_CURRENT" FIELDTYPE="Input" DATATYPE="String" LENGTH="1"/>
      </TRANSFORMATION>

      <!-- ===== CONNECTORS (Port Mappings) ===== -->
      <!-- Connector 1: SQ_STG_LOAN_APPLICATIONS -> EXP_DERIVE_LOOKUP_KEY -->
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:APPLICATION_ID" TARGET="EXP_DERIVE_LOOKUP_KEY:APPLICATION_ID"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:BORROWER_SSN_HASH" TARGET="EXP_DERIVE_LOOKUP_KEY:BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:CO_BORROWER_SSN_HASH" TARGET="EXP_DERIVE_LOOKUP_KEY:CO_BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_AMOUNT" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_AMOUNT"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_PURPOSE" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_PURPOSE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_TYPE" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_TYPE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:INTEREST_RATE" TARGET="EXP_DERIVE_LOOKUP_KEY:INTEREST_RATE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_TERM_MONTHS" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_TERM_MONTHS"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:DOWN_PAYMENT" TARGET="EXP_DERIVE_LOOKUP_KEY:DOWN_PAYMENT"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_TO_VALUE_PCT" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_TO_VALUE_PCT"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:DOWN_PAYMENT_PCT" TARGET="EXP_DERIVE_LOOKUP_KEY:DOWN_PAYMENT_PCT"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:OCCUPANCY_TYPE" TARGET="EXP_DERIVE_LOOKUP_KEY:OCCUPANCY_TYPE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:APPLICATION_DATE" TARGET="EXP_DERIVE_LOOKUP_KEY:APPLICATION_DATE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_TYPE_DESC" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_TYPE_DESC"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:IS_REFI" TARGET="EXP_DERIVE_LOOKUP_KEY:IS_REFI"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:APP_MONTH" TARGET="EXP_DERIVE_LOOKUP_KEY:APP_MONTH"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:LOAN_OFFICER_ID" TARGET="EXP_DERIVE_LOOKUP_KEY:LOAN_OFFICER_ID"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:BRANCH_CODE" TARGET="EXP_DERIVE_LOOKUP_KEY:BRANCH_CODE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:PROPERTY_STATE" TARGET="EXP_DERIVE_LOOKUP_KEY:PROPERTY_STATE"/>
      <CONNECTOR SOURCE="SQ_STG_LOAN_APPLICATIONS:STG_LOAD_DATE" TARGET="EXP_DERIVE_LOOKUP_KEY:STG_LOAD_DATE"/>

      <!-- Connector 2: EXP_DERIVE_LOOKUP_KEY -> LKP_CREDIT_BUREAU_SCORES (Unconnected Lookup Call) -->
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:LOOKUP_KEY" TARGET="LKP_CREDIT_BUREAU_SCORES:LOOKUP_KEY"/>

      <!-- Connector 3: EXP_DERIVE_LOOKUP_KEY -> EXP_ENRICH_CREDIT_DATA -->
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_APPLICATION_ID" TARGET="EXP_ENRICH_CREDIT_DATA:APPLICATION_ID"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_BORROWER_SSN_HASH" TARGET="EXP_ENRICH_CREDIT_DATA:BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_CO_BORROWER_SSN_HASH" TARGET="EXP_ENRICH_CREDIT_DATA:CO_BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_AMOUNT" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_AMOUNT"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_PURPOSE" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_PURPOSE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_TYPE" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_TYPE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_INTEREST_RATE" TARGET="EXP_ENRICH_CREDIT_DATA:INTEREST_RATE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_TERM_MONTHS" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_TERM_MONTHS"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_DOWN_PAYMENT" TARGET="EXP_ENRICH_CREDIT_DATA:DOWN_PAYMENT"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_TO_VALUE_PCT" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_TO_VALUE_PCT"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_DOWN_PAYMENT_PCT" TARGET="EXP_ENRICH_CREDIT_DATA:DOWN_PAYMENT_PCT"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_OCCUPANCY_TYPE" TARGET="EXP_ENRICH_CREDIT_DATA:OCCUPANCY_TYPE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_APPLICATION_DATE" TARGET="EXP_ENRICH_CREDIT_DATA:APPLICATION_DATE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_TYPE_DESC" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_TYPE_DESC"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_IS_REFI" TARGET="EXP_ENRICH_CREDIT_DATA:IS_REFI"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_APP_MONTH" TARGET="EXP_ENRICH_CREDIT_DATA:APP_MONTH"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_LOAN_OFFICER_ID" TARGET="EXP_ENRICH_CREDIT_DATA:LOAN_OFFICER_ID"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_BRANCH_CODE" TARGET="EXP_ENRICH_CREDIT_DATA:BRANCH_CODE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_PROPERTY_STATE" TARGET="EXP_ENRICH_CREDIT_DATA:PROPERTY_STATE"/>
      <CONNECTOR SOURCE="EXP_DERIVE_LOOKUP_KEY:o_STG_LOAD_DATE" TARGET="EXP_ENRICH_CREDIT_DATA:STG_LOAD_DATE"/>

      <!-- Connector 4: LKP_CREDIT_BUREAU_SCORES -> EXP_ENRICH_CREDIT_DATA (Lookup Results) -->
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:BUREAU_SCORE" TARGET="EXP_ENRICH_CREDIT_DATA:BUREAU_SCORE"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:SCORE_DATE" TARGET="EXP_ENRICH_CREDIT_DATA:SCORE_DATE"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:DEROGATORY_MARKS" TARGET="EXP_ENRICH_CREDIT_DATA:DEROGATORY_MARKS"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:INQUIRIES_6MO" TARGET="EXP_ENRICH_CREDIT_DATA:INQUIRIES_6MO"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:OPEN_ACCOUNTS" TARGET="EXP_ENRICH_CREDIT_DATA:OPEN_ACCOUNTS"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:CREDIT_UTILIZATION_PCT" TARGET="EXP_ENRICH_CREDIT_DATA:CREDIT_UTILIZATION_PCT"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:BANKRUPTCY_FLAG" TARGET="EXP_ENRICH_CREDIT_DATA:BANKRUPTCY_FLAG"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:FORECLOSURE_FLAG" TARGET="EXP_ENRICH_CREDIT_DATA:FORECLOSURE_FLAG"/>
      <CONNECTOR SOURCE="LKP_CREDIT_BUREAU_SCORES:BUREAU_CODE" TARGET="EXP_ENRICH_CREDIT_DATA:BUREAU_CODE"/>

      <!-- Connector 5: EXP_ENRICH_CREDIT_DATA -> UPD_SCD1_UPDATE -->
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_APPLICATION_ID" TARGET="UPD_SCD1_UPDATE:APPLICATION_ID"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_BORROWER_SSN_HASH" TARGET="UPD_SCD1_UPDATE:BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_CO_BORROWER_SSN_HASH" TARGET="UPD_SCD1_UPDATE:CO_BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_AMOUNT" TARGET="UPD_SCD1_UPDATE:LOAN_AMOUNT"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_PURPOSE" TARGET="UPD_SCD1_UPDATE:LOAN_PURPOSE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_TYPE" TARGET="UPD_SCD1_UPDATE:LOAN_TYPE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_INTEREST_RATE" TARGET="UPD_SCD1_UPDATE:INTEREST_RATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_TERM_MONTHS" TARGET="UPD_SCD1_UPDATE:LOAN_TERM_MONTHS"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_DOWN_PAYMENT" TARGET="UPD_SCD1_UPDATE:DOWN_PAYMENT"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_TO_VALUE_PCT" TARGET="UPD_SCD1_UPDATE:LOAN_TO_VALUE_PCT"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_DOWN_PAYMENT_PCT" TARGET="UPD_SCD1_UPDATE:DOWN_PAYMENT_PCT"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_OCCUPANCY_TYPE" TARGET="UPD_SCD1_UPDATE:OCCUPANCY_TYPE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_APPLICATION_DATE" TARGET="UPD_SCD1_UPDATE:APPLICATION_DATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_TYPE_DESC" TARGET="UPD_SCD1_UPDATE:LOAN_TYPE_DESC"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_IS_REFI" TARGET="UPD_SCD1_UPDATE:IS_REFI"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_APP_MONTH" TARGET="UPD_SCD1_UPDATE:APP_MONTH"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_LOAN_OFFICER_ID" TARGET="UPD_SCD1_UPDATE:LOAN_OFFICER_ID"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_BRANCH_CODE" TARGET="UPD_SCD1_UPDATE:BRANCH_CODE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_PROPERTY_STATE" TARGET="UPD_SCD1_UPDATE:PROPERTY_STATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_STG_LOAD_DATE" TARGET="UPD_SCD1_UPDATE:STG_LOAD_DATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_BUREAU_SCORE" TARGET="UPD_SCD1_UPDATE:BUREAU_SCORE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:CREDIT_TIER" TARGET="UPD_SCD1_UPDATE:CREDIT_TIER"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_DEROGATORY_MARKS" TARGET="UPD_SCD1_UPDATE:DEROGATORY_MARKS"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_INQUIRIES_6MO" TARGET="UPD_SCD1_UPDATE:INQUIRIES_6MO"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_OPEN_ACCOUNTS" TARGET="UPD_SCD1_UPDATE:OPEN_ACCOUNTS"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_CREDIT_UTILIZATION_PCT" TARGET="UPD_SCD1_UPDATE:CREDIT_UTILIZATION_PCT"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_BANKRUPTCY_FLAG" TARGET="UPD_SCD1_UPDATE:BANKRUPTCY_FLAG"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_FORECLOSURE_FLAG" TARGET="UPD_SCD1_UPDATE:FORECLOSURE_FLAG"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_BUREAU_CODE" TARGET="UPD_SCD1_UPDATE:BUREAU_CODE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:o_SCORE_DATE" TARGET="UPD_SCD1_UPDATE:SCORE_DATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:ENRICHMENT_DATE" TARGET="UPD_SCD1_UPDATE:ENRICHMENT_DATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:EFFECTIVE_DATE" TARGET="UPD_SCD1_UPDATE:EFFECTIVE_DATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:EXPIRY_DATE" TARGET="UPD_SCD1_UPDATE:EXPIRY_DATE"/>
      <CONNECTOR SOURCE="EXP_ENRICH_CREDIT_DATA:IS_CURRENT" TARGET="UPD_SCD1_UPDATE:IS_CURRENT"/>

      <!-- Connector 6: UPD_SCD1_UPDATE -> TGT_STG_LOAN_APPLICATIONS_ENRICHED -->
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_APPLICATION_ID" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:APPLICATION_ID"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_BORROWER_SSN_HASH" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_CO_BORROWER_SSN_HASH" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:CO_BORROWER_SSN_HASH"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_AMOUNT" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_AMOUNT"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_PURPOSE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_PURPOSE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_TYPE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_TYPE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_INTEREST_RATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:INTEREST_RATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_TERM_MONTHS" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_TERM_MONTHS"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_DOWN_PAYMENT" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:DOWN_PAYMENT"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_TO_VALUE_PCT" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_TO_VALUE_PCT"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_DOWN_PAYMENT_PCT" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:DOWN_PAYMENT_PCT"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_OCCUPANCY_TYPE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:OCCUPANCY_TYPE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_APPLICATION_DATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:APPLICATION_DATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_TYPE_DESC" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_TYPE_DESC"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_IS_REFI" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:IS_REFI"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_APP_MONTH" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:APP_MONTH"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_LOAN_OFFICER_ID" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:LOAN_OFFICER_ID"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_BRANCH_CODE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:BRANCH_CODE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_PROPERTY_STATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:PROPERTY_STATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_STG_LOAD_DATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:STG_LOAD_DATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_BUREAU_SCORE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:BUREAU_SCORE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_CREDIT_TIER" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:CREDIT_TIER"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_DEROGATORY_MARKS" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:DEROGATORY_MARKS"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_INQUIRIES_6MO" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:INQUIRIES_6MO"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_OPEN_ACCOUNTS" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:OPEN_ACCOUNTS"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_CREDIT_UTILIZATION_PCT" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:CREDIT_UTILIZATION_PCT"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_BANKRUPTCY_FLAG" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:BANKRUPTCY_FLAG"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_FORECLOSURE_FLAG" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:FORECLOSURE_FLAG"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_BUREAU_CODE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:BUREAU_CODE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_SCORE_DATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:SCORE_DATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_ENRICHMENT_DATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:ENRICHMENT_DATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_EFFECTIVE_DATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:EFFECTIVE_DATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_EXPIRY_DATE" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:EXPIRY_DATE"/>
      <CONNECTOR SOURCE="UPD_SCD1_UPDATE:o_IS_CURRENT" TARGET="TGT_STG_LOAN_APPLICATIONS_ENRICHED:IS_CURRENT"/>

    </MAPPING>

  </FOLDER>

</POWERMART>
