<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE POWERMART SYSTEM "powrmart.dtd">
<!--
  MAPPING : m_ZILLOW_VALUATIONS_to_STG
  TIER    : LOW (Simple)
  STACK   : dbt (SQL-friendly, single flat-file source, basic expressions)
  DOMAIN  : Mortgage / Property Intelligence
  CONTEXT : Zillow sends a daily CSV drop of property Zestimate valuations.
            This mapping reads the file, derives enrichment fields, filters bad
            records, and loads them to a staging table for downstream use by
            Fannie Mae underwriting and portfolio risk teams.
  FILE    : /data/inbound/zillow/ZILLOW_PROPERTY_VALUATIONS_YYYYMMDD.csv
-->
<POWERMART CREATION_DATE="02/01/2026 08:00:00" REPOSITORY_VERSION="186.96">
  <REPOSITORY NAME="MORTGAGE_REPO" VERSION="186" CODEPAGE="UTF-8" DATABASETYPE="Oracle">
    <FOLDER NAME="PROPERTY_ETL" GROUP="" OWNER="etl_admin" SHARED="NOTSHARED"
            DESCRIPTION="Property valuation loads — Zillow feed">

      <!-- ═══════════════════════════════════════════════════
           SOURCE: Zillow daily flat file
           Format: delimited CSV, header row, daily drop
      ══════════════════════════════════════════════════════ -->
      <SOURCE BUSINESSNAME="Zillow Property Valuations"
              DATABASETYPE="FLAT FILE"
              DESCRIPTION="Daily Zillow Zestimate property valuation export"
              NAME="ZILLOW_PROPERTY_VALUATIONS" OWNERNAME="">
        <SOURCEFIELD DATATYPE="string"  LENGTH="20"  NAME="PROPERTY_ID"      NULLABLE="NOTNULL" FIELDNUMBER="1"  FIELDTYPE="ELEMITEM" PRECISION="20"  SCALE="0"/>
        <SOURCEFIELD DATATYPE="string"  LENGTH="200" NAME="STREET_ADDRESS"   NULLABLE="NULL"    FIELDNUMBER="2"  FIELDTYPE="ELEMITEM" PRECISION="200" SCALE="0"/>
        <SOURCEFIELD DATATYPE="string"  LENGTH="100" NAME="CITY"             NULLABLE="NULL"    FIELDNUMBER="3"  FIELDTYPE="ELEMITEM" PRECISION="100" SCALE="0"/>
        <SOURCEFIELD DATATYPE="string"  LENGTH="2"   NAME="STATE_CODE"       NULLABLE="NULL"    FIELDNUMBER="4"  FIELDTYPE="ELEMITEM" PRECISION="2"   SCALE="0"/>
        <SOURCEFIELD DATATYPE="string"  LENGTH="10"  NAME="ZIP_CODE"         NULLABLE="NULL"    FIELDNUMBER="5"  FIELDTYPE="ELEMITEM" PRECISION="10"  SCALE="0"/>
        <SOURCEFIELD DATATYPE="decimal" LENGTH="15"  NAME="ZESTIMATE_VALUE"  NULLABLE="NULL"    FIELDNUMBER="6"  FIELDTYPE="ELEMITEM" PRECISION="15"  SCALE="2"/>
        <SOURCEFIELD DATATYPE="decimal" LENGTH="15"  NAME="PREV_ZESTIMATE"   NULLABLE="NULL"    FIELDNUMBER="7"  FIELDTYPE="ELEMITEM" PRECISION="15"  SCALE="2"/>
        <SOURCEFIELD DATATYPE="date"    LENGTH="29"  NAME="VALUATION_DATE"   NULLABLE="NULL"    FIELDNUMBER="8"  FIELDTYPE="ELEMITEM" PRECISION="29"  SCALE="9"/>
        <SOURCEFIELD DATATYPE="integer" LENGTH="4"   NAME="BEDROOMS"         NULLABLE="NULL"    FIELDNUMBER="9"  FIELDTYPE="ELEMITEM" PRECISION="4"   SCALE="0"/>
        <SOURCEFIELD DATATYPE="decimal" LENGTH="4"   NAME="BATHROOMS"        NULLABLE="NULL"    FIELDNUMBER="10" FIELDTYPE="ELEMITEM" PRECISION="4"   SCALE="1"/>
        <SOURCEFIELD DATATYPE="integer" LENGTH="8"   NAME="SQFT"             NULLABLE="NULL"    FIELDNUMBER="11" FIELDTYPE="ELEMITEM" PRECISION="8"   SCALE="0"/>
        <SOURCEFIELD DATATYPE="string"  LENGTH="20"  NAME="PROPERTY_TYPE"    NULLABLE="NULL"    FIELDNUMBER="12" FIELDTYPE="ELEMITEM" PRECISION="20"  SCALE="0"/>
        <SOURCEFIELD DATATYPE="string"  LENGTH="10"  NAME="ZILLOW_STATUS"    NULLABLE="NULL"    FIELDNUMBER="13" FIELDTYPE="ELEMITEM" PRECISION="10"  SCALE="0"/>
        <!-- File attributes -->
        <TABLEATTRIBUTE NAME="Delimited"    VALUE="YES"/>
        <TABLEATTRIBUTE NAME="Delimiter"    VALUE=","/>
        <TABLEATTRIBUTE NAME="TextQualifier" VALUE='"'/>
        <TABLEATTRIBUTE NAME="HeaderExists" VALUE="YES"/>
        <TABLEATTRIBUTE NAME="RowsToSkip"   VALUE="1"/>
      </SOURCE>

      <!-- ═══════════════════════════════════════════════════
           TARGET: Staging table — Snowflake DWH
      ══════════════════════════════════════════════════════ -->
      <TARGET BUSINESSNAME="Staging Property Valuations"
              DATABASETYPE="Snowflake"
              DESCRIPTION="Zillow property valuation staging table"
              NAME="STG_PROPERTY_VALUATIONS" OWNERNAME="MORTGAGE_STG">
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="20"  NAME="PROPERTY_ID"       KEYTYPE="PRIMARY KEY" FIELDNUMBER="1"  PRECISION="20"  SCALE="0" NULLABLE="NOTNULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="200" NAME="STREET_ADDRESS"    KEYTYPE="NOT A KEY"   FIELDNUMBER="2"  PRECISION="200" SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="100" NAME="CITY"              KEYTYPE="NOT A KEY"   FIELDNUMBER="3"  PRECISION="100" SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="2"   NAME="STATE_CODE"        KEYTYPE="NOT A KEY"   FIELDNUMBER="4"  PRECISION="2"   SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="10"  NAME="ZIP_CODE"          KEYTYPE="NOT A KEY"   FIELDNUMBER="5"  PRECISION="10"  SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="15"  NAME="ZESTIMATE_VALUE"   KEYTYPE="NOT A KEY"   FIELDNUMBER="6"  PRECISION="15"  SCALE="2" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="15"  NAME="PREV_ZESTIMATE"    KEYTYPE="NOT A KEY"   FIELDNUMBER="7"  PRECISION="15"  SCALE="2" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="15"  NAME="VALUE_CHANGE"      KEYTYPE="NOT A KEY"   FIELDNUMBER="8"  PRECISION="15"  SCALE="2" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="7"   NAME="VALUE_CHANGE_PCT"  KEYTYPE="NOT A KEY"   FIELDNUMBER="9"  PRECISION="7"   SCALE="4" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="DATE"      LENGTH="29"  NAME="VALUATION_DATE"    KEYTYPE="NOT A KEY"   FIELDNUMBER="10" PRECISION="29"  SCALE="9" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="7"   NAME="VALUATION_MONTH"   KEYTYPE="NOT A KEY"   FIELDNUMBER="11" PRECISION="7"   SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="4"   NAME="BEDROOMS"          KEYTYPE="NOT A KEY"   FIELDNUMBER="12" PRECISION="4"   SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="4"   NAME="BATHROOMS"         KEYTYPE="NOT A KEY"   FIELDNUMBER="13" PRECISION="4"   SCALE="1" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="8"   NAME="SQFT"              KEYTYPE="NOT A KEY"   FIELDNUMBER="14" PRECISION="8"   SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="NUMBER"    LENGTH="10"  NAME="PRICE_PER_SQFT"    KEYTYPE="NOT A KEY"   FIELDNUMBER="15" PRECISION="10"  SCALE="2" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="20"  NAME="PROPERTY_TYPE"     KEYTYPE="NOT A KEY"   FIELDNUMBER="16" PRECISION="20"  SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="1"   NAME="IS_HIGH_VALUE"     KEYTYPE="NOT A KEY"   FIELDNUMBER="17" PRECISION="1"   SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="20"  NAME="VALUE_TIER"        KEYTYPE="NOT A KEY"   FIELDNUMBER="18" PRECISION="20"  SCALE="0" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="DATE"      LENGTH="29"  NAME="ETL_LOAD_DATE"     KEYTYPE="NOT A KEY"   FIELDNUMBER="19" PRECISION="29"  SCALE="9" NULLABLE="NULL"/>
        <TARGETFIELD DATATYPE="VARCHAR2"  LENGTH="50"  NAME="ETL_SOURCE_FILE"   KEYTYPE="NOT A KEY"   FIELDNUMBER="20" PRECISION="50"  SCALE="0" NULLABLE="NULL"/>
      </TARGET>

      <!-- ═══════════════════════════════════════════════════
           MAPPING
      ══════════════════════════════════════════════════════ -->
      <MAPPING DESCRIPTION="Load Zillow daily property Zestimate valuations to staging. Derives value change, price per sqft, valuation tier, and high-value flag. Filters records with zero or null Zestimate."
               ISVALID="YES" NAME="m_ZILLOW_VALUATIONS_to_STG"
               OBJECTVERSION="1" VERSIONNUMBER="1">

        <!-- Source Qualifier — flat file reader -->
        <TRANSFORMATION NAME="SQ_ZILLOW_PROPERTY_VALUATIONS" TYPE="Source Qualifier"
                        REUSABLE="NO" OBJECTVERSION="1" VERSIONNUMBER="1"
                        DESCRIPTION="Read Zillow daily CSV file. Filter out records with missing or zero Zestimate.">
          <TRANSFORMFIELD DATATYPE="string"  NAME="PROPERTY_ID"     PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="20"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="STREET_ADDRESS"  PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="200" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="CITY"            PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="100" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="STATE_CODE"      PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="2"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="ZIP_CODE"        PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="10"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="ZESTIMATE_VALUE" PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="PREV_ZESTIMATE"  PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="date"    NAME="VALUATION_DATE"  PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="29"  SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="integer" NAME="BEDROOMS"        PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="4"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="BATHROOMS"       PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="4"   SCALE="1"/>
          <TRANSFORMFIELD DATATYPE="integer" NAME="SQFT"            PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="8"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="PROPERTY_TYPE"   PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="20"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="ZILLOW_STATUS"   PORTTYPE="OUTPUT" EXPRESSION="" PRECISION="10"  SCALE="0"/>
          <TABLEATTRIBUTE NAME="Sql Query"     VALUE=""/>
          <TABLEATTRIBUTE NAME="Source Filter" VALUE="ZESTIMATE_VALUE IS NOT NULL AND ZESTIMATE_VALUE > 0"/>
          <TABLEATTRIBUTE NAME="Number Of Sorted Ports" VALUE="0"/>
        </TRANSFORMATION>

        <!-- Expression — derive enrichment columns -->
        <TRANSFORMATION NAME="EXP_ENRICH_VALUATION" TYPE="Expression"
                        REUSABLE="NO" OBJECTVERSION="1" VERSIONNUMBER="1"
                        DESCRIPTION="Derive value change, price per sqft, valuation month, value tier, and high-value flag.">
          <!-- Pass-through input ports -->
          <TRANSFORMFIELD DATATYPE="string"  NAME="PROPERTY_ID"     PORTTYPE="INPUT/OUTPUT" EXPRESSION="PROPERTY_ID"    PRECISION="20"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="STREET_ADDRESS"  PORTTYPE="INPUT/OUTPUT" EXPRESSION="STREET_ADDRESS"  PRECISION="200" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="CITY"            PORTTYPE="INPUT/OUTPUT" EXPRESSION="CITY"            PRECISION="100" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="STATE_CODE"      PORTTYPE="INPUT/OUTPUT" EXPRESSION="STATE_CODE"      PRECISION="2"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="ZIP_CODE"        PORTTYPE="INPUT/OUTPUT" EXPRESSION="ZIP_CODE"        PRECISION="10"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="ZESTIMATE_VALUE" PORTTYPE="INPUT/OUTPUT" EXPRESSION="ZESTIMATE_VALUE" PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="PREV_ZESTIMATE"  PORTTYPE="INPUT/OUTPUT" EXPRESSION="PREV_ZESTIMATE"  PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="date"    NAME="VALUATION_DATE"  PORTTYPE="INPUT/OUTPUT" EXPRESSION="VALUATION_DATE"  PRECISION="29"  SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="integer" NAME="BEDROOMS"        PORTTYPE="INPUT/OUTPUT" EXPRESSION="BEDROOMS"        PRECISION="4"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="BATHROOMS"       PORTTYPE="INPUT/OUTPUT" EXPRESSION="BATHROOMS"       PRECISION="4"   SCALE="1"/>
          <TRANSFORMFIELD DATATYPE="integer" NAME="SQFT"            PORTTYPE="INPUT/OUTPUT" EXPRESSION="SQFT"            PRECISION="8"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="PROPERTY_TYPE"   PORTTYPE="INPUT/OUTPUT" EXPRESSION="PROPERTY_TYPE"   PRECISION="20"  SCALE="0"/>
          <!-- Derived: dollar change vs prior Zestimate -->
          <TRANSFORMFIELD DATATYPE="decimal" NAME="VALUE_CHANGE"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="ZESTIMATE_VALUE - IIF(ISNULL(PREV_ZESTIMATE), ZESTIMATE_VALUE, PREV_ZESTIMATE)"
                          PRECISION="15" SCALE="2"/>
          <!-- Derived: % change rounded to 4dp -->
          <TRANSFORMFIELD DATATYPE="decimal" NAME="VALUE_CHANGE_PCT"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="IIF(ISNULL(PREV_ZESTIMATE) OR PREV_ZESTIMATE = 0, 0, ROUND((ZESTIMATE_VALUE - PREV_ZESTIMATE) / PREV_ZESTIMATE, 4))"
                          PRECISION="7" SCALE="4"/>
          <!-- Derived: YYYY-MM month bucket for partitioning -->
          <TRANSFORMFIELD DATATYPE="string" NAME="VALUATION_MONTH"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="TO_CHAR(VALUATION_DATE, 'YYYY-MM')"
                          PRECISION="7" SCALE="0"/>
          <!-- Derived: price per sq ft (guard div-by-zero) -->
          <TRANSFORMFIELD DATATYPE="decimal" NAME="PRICE_PER_SQFT"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="IIF(ISNULL(SQFT) OR SQFT = 0, NULL, ROUND(ZESTIMATE_VALUE / SQFT, 2))"
                          PRECISION="10" SCALE="2"/>
          <!-- Derived: Fannie Mae conforming loan threshold flag ($726,200 2024 baseline) -->
          <TRANSFORMFIELD DATATYPE="string" NAME="IS_HIGH_VALUE"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="IIF(ZESTIMATE_VALUE > 726200, 'Y', 'N')"
                          PRECISION="1" SCALE="0"/>
          <!-- Derived: value tier for portfolio segmentation -->
          <TRANSFORMFIELD DATATYPE="string" NAME="VALUE_TIER"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="IIF(ZESTIMATE_VALUE >= 2000000, 'JUMBO_SUPER',
                                      IIF(ZESTIMATE_VALUE >= 1000000, 'JUMBO',
                                      IIF(ZESTIMATE_VALUE >= 726200,  'HIGH_BALANCE',
                                      IIF(ZESTIMATE_VALUE >= 400000,  'MID_MARKET',
                                      IIF(ZESTIMATE_VALUE >= 150000,  'AFFORDABLE', 'BELOW_MIN')))))"
                          PRECISION="20" SCALE="0"/>
          <!-- ETL audit fields -->
          <TRANSFORMFIELD DATATYPE="date"   NAME="ETL_LOAD_DATE"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="SYSDATE"
                          PRECISION="29" SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="string" NAME="ETL_SOURCE_FILE"
                          PORTTYPE="OUTPUT"
                          EXPRESSION="'ZILLOW_PROPERTY_VALUATIONS_' || TO_CHAR(SYSDATE, 'YYYYMMDD') || '.csv'"
                          PRECISION="50" SCALE="0"/>
        </TRANSFORMATION>

        <!-- Target instance -->
        <TRANSFORMATION NAME="TGT_STG_PROPERTY_VALUATIONS" TYPE="Target Definition"
                        REUSABLE="NO" OBJECTVERSION="1" VERSIONNUMBER="1">
          <TRANSFORMFIELD DATATYPE="string"  NAME="PROPERTY_ID"      PORTTYPE="INPUT" PRECISION="20"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="STREET_ADDRESS"   PORTTYPE="INPUT" PRECISION="200" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="CITY"             PORTTYPE="INPUT" PRECISION="100" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="STATE_CODE"       PORTTYPE="INPUT" PRECISION="2"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="ZIP_CODE"         PORTTYPE="INPUT" PRECISION="10"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="ZESTIMATE_VALUE"  PORTTYPE="INPUT" PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="PREV_ZESTIMATE"   PORTTYPE="INPUT" PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="VALUE_CHANGE"     PORTTYPE="INPUT" PRECISION="15"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="VALUE_CHANGE_PCT" PORTTYPE="INPUT" PRECISION="7"   SCALE="4"/>
          <TRANSFORMFIELD DATATYPE="date"    NAME="VALUATION_DATE"   PORTTYPE="INPUT" PRECISION="29"  SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="VALUATION_MONTH"  PORTTYPE="INPUT" PRECISION="7"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="integer" NAME="BEDROOMS"         PORTTYPE="INPUT" PRECISION="4"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="BATHROOMS"        PORTTYPE="INPUT" PRECISION="4"   SCALE="1"/>
          <TRANSFORMFIELD DATATYPE="integer" NAME="SQFT"             PORTTYPE="INPUT" PRECISION="8"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="decimal" NAME="PRICE_PER_SQFT"   PORTTYPE="INPUT" PRECISION="10"  SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="PROPERTY_TYPE"    PORTTYPE="INPUT" PRECISION="20"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="IS_HIGH_VALUE"    PORTTYPE="INPUT" PRECISION="1"   SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="VALUE_TIER"       PORTTYPE="INPUT" PRECISION="20"  SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="date"    NAME="ETL_LOAD_DATE"    PORTTYPE="INPUT" PRECISION="29"  SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="string"  NAME="ETL_SOURCE_FILE"  PORTTYPE="INPUT" PRECISION="50"  SCALE="0"/>
        </TRANSFORMATION>

        <!-- ═══ CONNECTORS ═══════════════════════════════════════ -->
        <!-- SQ → EXP -->
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="PROPERTY_ID"     TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="PROPERTY_ID"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="STREET_ADDRESS"  TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="STREET_ADDRESS"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="CITY"            TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="CITY"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="STATE_CODE"      TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="STATE_CODE"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="ZIP_CODE"        TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="ZIP_CODE"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="ZESTIMATE_VALUE" TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="ZESTIMATE_VALUE"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="PREV_ZESTIMATE"  TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="PREV_ZESTIMATE"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="VALUATION_DATE"  TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="VALUATION_DATE"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="BEDROOMS"        TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="BEDROOMS"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="BATHROOMS"       TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="BATHROOMS"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="SQFT"            TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="SQFT"/>
        <CONNECTOR FROMINSTANCE="SQ_ZILLOW_PROPERTY_VALUATIONS" FROMINSTANCETYPE="Source Qualifier" FROMFIELD="PROPERTY_TYPE"   TOINSTANCE="EXP_ENRICH_VALUATION" TOINSTANCETYPE="Expression" TOFIELD="PROPERTY_TYPE"/>

        <!-- EXP → Target -->
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="PROPERTY_ID"      TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="PROPERTY_ID"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="STREET_ADDRESS"   TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="STREET_ADDRESS"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="CITY"             TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="CITY"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="STATE_CODE"       TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="STATE_CODE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="ZIP_CODE"         TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="ZIP_CODE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="ZESTIMATE_VALUE"  TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="ZESTIMATE_VALUE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="PREV_ZESTIMATE"   TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="PREV_ZESTIMATE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="VALUE_CHANGE"     TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="VALUE_CHANGE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="VALUE_CHANGE_PCT" TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="VALUE_CHANGE_PCT"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="VALUATION_DATE"   TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="VALUATION_DATE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="VALUATION_MONTH"  TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="VALUATION_MONTH"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="BEDROOMS"         TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="BEDROOMS"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="BATHROOMS"        TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="BATHROOMS"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="SQFT"             TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="SQFT"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="PRICE_PER_SQFT"   TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="PRICE_PER_SQFT"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="PROPERTY_TYPE"    TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="PROPERTY_TYPE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="IS_HIGH_VALUE"    TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="IS_HIGH_VALUE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="VALUE_TIER"       TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="VALUE_TIER"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="ETL_LOAD_DATE"    TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="ETL_LOAD_DATE"/>
        <CONNECTOR FROMINSTANCE="EXP_ENRICH_VALUATION" FROMINSTANCETYPE="Expression" FROMFIELD="ETL_SOURCE_FILE"  TOINSTANCE="TGT_STG_PROPERTY_VALUATIONS" TOINSTANCETYPE="Target Definition" TOFIELD="ETL_SOURCE_FILE"/>

        <!-- Source → Transformation instance link -->
        <INSTANCE NAME="SQ_ZILLOW_PROPERTY_VALUATIONS" TRANSFORMATION_NAME="SQ_ZILLOW_PROPERTY_VALUATIONS" TYPE="Source Qualifier" REUSABLE="NO"/>
        <INSTANCE NAME="EXP_ENRICH_VALUATION"           TRANSFORMATION_NAME="EXP_ENRICH_VALUATION"          TYPE="Expression"       REUSABLE="NO"/>
        <INSTANCE NAME="TGT_STG_PROPERTY_VALUATIONS"    TRANSFORMATION_NAME="TGT_STG_PROPERTY_VALUATIONS"   TYPE="Target Definition" REUSABLE="NO"/>

      </MAPPING>
    </FOLDER>
  </REPOSITORY>
</POWERMART>
