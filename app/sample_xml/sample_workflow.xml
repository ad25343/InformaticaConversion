<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE POWERMART SYSTEM "powrmart.dtd">
<!--
  Sample Workflow XML paired with sample_mapping.xml and sample_params.txt.
  Upload all three files together to exercise the v1.1 multi-file upload.

  Workflow : WF_STG_ORDERS_to_FACT_ORDERS
  Session  : s_STG_ORDERS_to_FACT_ORDERS
  Mapping  : m_STG_ORDERS_to_FACT_ORDERS (matches MAPPING NAME in sample_mapping.xml)
-->
<POWERMART CREATION_DATE="02/21/2026 10:00:00" REPOSITORY_VERSION="186.96">
  <REPOSITORY NAME="DEV_REPO" VERSION="186" CODEPAGE="UTF-8" DATABASETYPE="Oracle">
    <FOLDER NAME="SALES_ETL" GROUP="" OWNER="admin" SHARED="NOTSHARED"
            DESCRIPTION="Sales ETL Workflows">

      <WORKFLOW DESCRIPTION="Load STG_ORDERS into FACT_ORDERS"
                NAME="WF_STG_ORDERS_to_FACT_ORDERS"
                REUSABLE="NO"
                SCHEDULERNAME="Scheduler"
                SERVERNAME="DEV_IS"
                ISENABLED="YES">

        <!-- Start task -->
        <TASK DESCRIPTION="" NAME="Start" REUSABLE="NO" TYPE="Start"/>

        <!-- Session task -->
        <SESSION DESCRIPTION="Load FACT_ORDERS from STG_ORDERS"
                 NAME="s_STG_ORDERS_to_FACT_ORDERS"
                 MAPPINGNAME="m_STG_ORDERS_to_FACT_ORDERS"
                 REUSABLE="NO">

          <!-- Connection references -->
          <CONNECTIONREFERENCE
            CONNECTIONNAME="$$SRC_CONNECTION"
            CONNECTIONSUBTYPE="Oracle"
            CONNECTIONTYPE="Relational"
            TRANSFORMATIONINSTANCENAME="SQ_STG_ORDERS"
            ROLE="SOURCE"/>

          <CONNECTIONREFERENCE
            CONNECTIONNAME="$$TGT_CONNECTION"
            CONNECTIONSUBTYPE="Oracle"
            CONNECTIONTYPE="Relational"
            TRANSFORMATIONINSTANCENAME="FACT_ORDERS"
            ROLE="TARGET"/>

          <!-- Source qualifier overrides -->
          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="SQ_STG_ORDERS"
            ATTRIBUTENAME="Sql Query"
            ATTRIBUTEVALUE="SELECT * FROM SALES.STG_ORDERS WHERE ORDER_DATE &gt;= TO_DATE('$$LOAD_DATE','YYYY-MM-DD')"/>

          <!-- Commit and error config -->
          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="s_STG_ORDERS_to_FACT_ORDERS"
            ATTRIBUTENAME="Commit Interval"
            ATTRIBUTEVALUE="10000"/>

          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="s_STG_ORDERS_to_FACT_ORDERS"
            ATTRIBUTENAME="Stop On Errors"
            ATTRIBUTEVALUE="0"/>

          <!-- Reject file config -->
          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="FACT_ORDERS"
            ATTRIBUTENAME="Reject Filename"
            ATTRIBUTEVALUE="FACT_ORDERS_$$LOAD_DATE.bad"/>

          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="FACT_ORDERS"
            ATTRIBUTENAME="Reject File Directory"
            ATTRIBUTEVALUE="$$REJECT_FILE_DIR"/>

          <!-- Pre / post session SQL -->
          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="FACT_ORDERS"
            ATTRIBUTENAME="Pre SQL"
            ATTRIBUTEVALUE="DELETE FROM DWH.FACT_ORDERS WHERE ORDER_YEAR_MONTH = TO_CHAR(TO_DATE('$$LOAD_DATE','YYYY-MM-DD'),'YYYYMM')"/>

          <SESSTRANSFORMINSTATTR
            TRANSFORMATIONINSTANCENAME="FACT_ORDERS"
            ATTRIBUTENAME="Post SQL"
            ATTRIBUTEVALUE="UPDATE DWH.ETL_AUDIT SET STATUS='COMPLETE', UPDATED_AT=SYSDATE WHERE JOB_NAME='WF_STG_ORDERS_to_FACT_ORDERS'"/>

        </SESSION>

        <!-- Workflow task links -->
        <TASKINSTANCEPATH FROM="Start" TO="s_STG_ORDERS_to_FACT_ORDERS"/>

      </WORKFLOW>

    </FOLDER>
  </REPOSITORY>
</POWERMART>
