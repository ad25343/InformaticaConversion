<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE POWERMART SYSTEM "powrmart.dtd">
<POWERMART CREATION_DATE="02/21/2026 10:00:00" REPOSITORY_VERSION="186.96">
  <REPOSITORY NAME="DEV_REPO" VERSION="186" CODEPAGE="UTF-8" DATABASETYPE="Oracle">

    <FOLDER NAME="SALES_ETL" GROUP="" OWNER="admin" SHARED="NOTSHARED" DESCRIPTION="Sales ETL Mappings">

      <!-- SOURCE DEFINITION -->
      <SOURCE BUSINESSNAME="" DATABASETYPE="Oracle" DBDNAME="SALES_DB"
              DESCRIPTION="Source orders table" NAME="STG_ORDERS" OWNERNAME="SALES"
              READONLY="NO">
        <SOURCEFIELD BUSINESSNAME="" DATATYPE="NUMBER" DESCRIPTION="" FIELDNUMBER="1"
                     FIELDPROPERTY="0" FIELDTYPE="ELEMITEM" HIDDEN="NO"
                     LENGTH="10" LEVEL="0" NAME="ORDER_ID" NULLABLE="NOTNULL"
                     PICTURETEXT="" PRECISION="10" SCALE="0"/>
        <SOURCEFIELD BUSINESSNAME="" DATATYPE="VARCHAR2" DESCRIPTION="" FIELDNUMBER="2"
                     FIELDPROPERTY="0" FIELDTYPE="ELEMITEM" HIDDEN="NO"
                     LENGTH="50" LEVEL="0" NAME="CUSTOMER_NAME" NULLABLE="NULL"
                     PICTURETEXT="" PRECISION="50" SCALE="0"/>
        <SOURCEFIELD BUSINESSNAME="" DATATYPE="NUMBER" DESCRIPTION="" FIELDNUMBER="3"
                     FIELDPROPERTY="0" FIELDTYPE="ELEMITEM" HIDDEN="NO"
                     LENGTH="15" LEVEL="0" NAME="ORDER_AMOUNT" NULLABLE="NULL"
                     PICTURETEXT="" PRECISION="15" SCALE="2"/>
        <SOURCEFIELD BUSINESSNAME="" DATATYPE="DATE" DESCRIPTION="" FIELDNUMBER="4"
                     FIELDPROPERTY="0" FIELDTYPE="ELEMITEM" HIDDEN="NO"
                     LENGTH="29" LEVEL="0" NAME="ORDER_DATE" NULLABLE="NULL"
                     PICTURETEXT="" PRECISION="29" SCALE="9"/>
        <SOURCEFIELD BUSINESSNAME="" DATATYPE="VARCHAR2" DESCRIPTION="" FIELDNUMBER="5"
                     FIELDPROPERTY="0" FIELDTYPE="ELEMITEM" HIDDEN="NO"
                     LENGTH="20" LEVEL="0" NAME="STATUS" NULLABLE="NULL"
                     PICTURETEXT="" PRECISION="20" SCALE="0"/>
      </SOURCE>

      <!-- TARGET DEFINITION -->
      <TARGET BUSINESSNAME="" DATABASETYPE="Oracle" DESCRIPTION="Target fact table"
              NAME="FACT_ORDERS" OWNERNAME="DWH">
        <TARGETFIELD BUSINESSNAME="" DATATYPE="NUMBER" DESCRIPTION="" FIELDNUMBER="1"
                     KEYTYPE="PRIMARY KEY" LENGTH="10" LEVEL="0" NAME="ORDER_KEY"
                     NULLABLE="NOTNULL" PICTURETEXT="" PRECISION="10" SCALE="0"/>
        <TARGETFIELD BUSINESSNAME="" DATATYPE="VARCHAR2" DESCRIPTION="" FIELDNUMBER="2"
                     KEYTYPE="NOT A KEY" LENGTH="50" LEVEL="0" NAME="CUSTOMER_NAME_CLEAN"
                     NULLABLE="NULL" PICTURETEXT="" PRECISION="50" SCALE="0"/>
        <TARGETFIELD BUSINESSNAME="" DATATYPE="NUMBER" DESCRIPTION="" FIELDNUMBER="3"
                     KEYTYPE="NOT A KEY" LENGTH="15" LEVEL="0" NAME="ORDER_AMOUNT"
                     NULLABLE="NULL" PICTURETEXT="" PRECISION="15" SCALE="2"/>
        <TARGETFIELD BUSINESSNAME="" DATATYPE="NUMBER" DESCRIPTION="" FIELDNUMBER="4"
                     KEYTYPE="NOT A KEY" LENGTH="15" LEVEL="0" NAME="TAX_AMOUNT"
                     NULLABLE="NULL" PICTURETEXT="" PRECISION="15" SCALE="2"/>
        <TARGETFIELD BUSINESSNAME="" DATATYPE="VARCHAR2" DESCRIPTION="" FIELDNUMBER="5"
                     KEYTYPE="NOT A KEY" LENGTH="10" LEVEL="0" NAME="ORDER_YEAR_MONTH"
                     NULLABLE="NULL" PICTURETEXT="" PRECISION="10" SCALE="0"/>
        <TARGETFIELD BUSINESSNAME="" DATATYPE="VARCHAR2" DESCRIPTION="" FIELDNUMBER="6"
                     KEYTYPE="NOT A KEY" LENGTH="20" LEVEL="0" NAME="STATUS_DESC"
                     NULLABLE="NULL" PICTURETEXT="" PRECISION="20" SCALE="0"/>
        <TARGETFIELD BUSINESSNAME="" DATATYPE="VARCHAR2" DESCRIPTION="" FIELDNUMBER="7"
                     KEYTYPE="NOT A KEY" LENGTH="1" LEVEL="0" NAME="IS_HIGH_VALUE"
                     NULLABLE="NULL" PICTURETEXT="" PRECISION="1" SCALE="0"/>
      </TARGET>

      <!-- MAPPING -->
      <MAPPING DESCRIPTION="Load orders to fact table with business rules" ISVALID="YES"
               NAME="m_STG_ORDERS_to_FACT_ORDERS" OBJECTVERSION="1" VERSIONNUMBER="1">

        <!-- Source Qualifier -->
        <TRANSFORMATION DESCRIPTION="Source qualifier for STG_ORDERS"
                        NAME="SQ_STG_ORDERS" OBJECTVERSION="1"
                        REUSABLE="NO" TYPE="Source Qualifier" VERSIONNUMBER="1">
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="" EXPRESSIONTYPE="GENERAL" NAME="ORDER_ID"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="10" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="" EXPRESSIONTYPE="GENERAL" NAME="CUSTOMER_NAME"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="50" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="" EXPRESSIONTYPE="GENERAL" NAME="ORDER_AMOUNT"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="15" SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="DATE" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="" EXPRESSIONTYPE="GENERAL" NAME="ORDER_DATE"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="29" SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="" EXPRESSIONTYPE="GENERAL" NAME="STATUS"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="20" SCALE="0"/>
          <TABLEATTRIBUTE NAME="Sql Query" VALUE=""/>
          <TABLEATTRIBUTE NAME="User Defined Join" VALUE=""/>
          <TABLEATTRIBUTE NAME="Source Filter" VALUE="STATUS != &apos;CANCELLED&apos;"/>
        </TRANSFORMATION>

        <!-- Expression Transformation -->
        <TRANSFORMATION DESCRIPTION="Apply business rules and derivations"
                        NAME="EXP_BUSINESS_RULES" OBJECTVERSION="1"
                        REUSABLE="NO" TYPE="Expression" VERSIONNUMBER="1">
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="ORDER_ID" EXPRESSIONTYPE="GENERAL" NAME="ORDER_ID"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="10" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="CUSTOMER_NAME" EXPRESSIONTYPE="GENERAL" NAME="CUSTOMER_NAME"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="50" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="ORDER_AMOUNT" EXPRESSIONTYPE="GENERAL" NAME="ORDER_AMOUNT"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="DATE" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="ORDER_DATE" EXPRESSIONTYPE="GENERAL" NAME="ORDER_DATE"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="29" SCALE="9"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="STATUS" EXPRESSIONTYPE="GENERAL" NAME="STATUS"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="20" SCALE="0"/>
          <!-- Derived fields -->
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION="Cleaned customer name"
                          EXPRESSION="UPPER(LTRIM(RTRIM(CUSTOMER_NAME)))"
                          EXPRESSIONTYPE="GENERAL" NAME="CUSTOMER_NAME_CLEAN"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="50" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION="Tax at 8.5%"
                          EXPRESSION="ROUND(ORDER_AMOUNT * 0.085, 2)"
                          EXPRESSIONTYPE="GENERAL" NAME="TAX_AMOUNT"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="15" SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION="Year-month for partitioning"
                          EXPRESSION="TO_CHAR(ORDER_DATE, &apos;YYYY-MM&apos;)"
                          EXPRESSIONTYPE="GENERAL" NAME="ORDER_YEAR_MONTH"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="10" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION="Human-readable status"
                          EXPRESSION="DECODE(STATUS, &apos;COMP&apos;, &apos;COMPLETED&apos;, &apos;PEND&apos;, &apos;PENDING&apos;, &apos;PROC&apos;, &apos;PROCESSING&apos;, &apos;UNKNOWN&apos;)"
                          EXPRESSIONTYPE="GENERAL" NAME="STATUS_DESC"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="20" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION="Flag for high-value orders over $10000"
                          EXPRESSION="IIF(ORDER_AMOUNT &gt; 10000, &apos;Y&apos;, &apos;N&apos;)"
                          EXPRESSIONTYPE="GENERAL" NAME="IS_HIGH_VALUE"
                          PICTURETEXT="" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
        </TRANSFORMATION>

        <!-- Filter Transformation -->
        <TRANSFORMATION DESCRIPTION="Filter out zero-amount orders"
                        NAME="FIL_VALID_ORDERS" OBJECTVERSION="1"
                        REUSABLE="NO" TYPE="Filter" VERSIONNUMBER="1">
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="ORDER_ID" EXPRESSIONTYPE="GENERAL" NAME="ORDER_ID"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="10" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="CUSTOMER_NAME_CLEAN" EXPRESSIONTYPE="GENERAL" NAME="CUSTOMER_NAME_CLEAN"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="50" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="ORDER_AMOUNT" EXPRESSIONTYPE="GENERAL" NAME="ORDER_AMOUNT"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="NUMBER" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="TAX_AMOUNT" EXPRESSIONTYPE="GENERAL" NAME="TAX_AMOUNT"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="15" SCALE="2"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="ORDER_YEAR_MONTH" EXPRESSIONTYPE="GENERAL" NAME="ORDER_YEAR_MONTH"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="10" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="STATUS_DESC" EXPRESSIONTYPE="GENERAL" NAME="STATUS_DESC"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="20" SCALE="0"/>
          <TRANSFORMFIELD DATATYPE="VARCHAR2" DEFAULTVALUE="" DESCRIPTION=""
                          EXPRESSION="IS_HIGH_VALUE" EXPRESSIONTYPE="GENERAL" NAME="IS_HIGH_VALUE"
                          PICTURETEXT="" PORTTYPE="INPUT/OUTPUT" PRECISION="1" SCALE="0"/>
          <TABLEATTRIBUTE NAME="Filter Condition" VALUE="ORDER_AMOUNT &gt; 0"/>
        </TRANSFORMATION>

        <!-- Connectors -->
        <CONNECTOR FROMFIELD="ORDER_ID"    FROMMAPPING="NO" FROMINSTANCE="SQ_STG_ORDERS" FROMINSTANCETYPE="Source Qualifier" TOFIELD="ORDER_ID"    TOINSTANCE="EXP_BUSINESS_RULES" TOINSTANCETYPE="Expression"/>
        <CONNECTOR FROMFIELD="CUSTOMER_NAME" FROMMAPPING="NO" FROMINSTANCE="SQ_STG_ORDERS" FROMINSTANCETYPE="Source Qualifier" TOFIELD="CUSTOMER_NAME" TOINSTANCE="EXP_BUSINESS_RULES" TOINSTANCETYPE="Expression"/>
        <CONNECTOR FROMFIELD="ORDER_AMOUNT"  FROMMAPPING="NO" FROMINSTANCE="SQ_STG_ORDERS" FROMINSTANCETYPE="Source Qualifier" TOFIELD="ORDER_AMOUNT"  TOINSTANCE="EXP_BUSINESS_RULES" TOINSTANCETYPE="Expression"/>
        <CONNECTOR FROMFIELD="ORDER_DATE"    FROMMAPPING="NO" FROMINSTANCE="SQ_STG_ORDERS" FROMINSTANCETYPE="Source Qualifier" TOFIELD="ORDER_DATE"    TOINSTANCE="EXP_BUSINESS_RULES" TOINSTANCETYPE="Expression"/>
        <CONNECTOR FROMFIELD="STATUS"        FROMMAPPING="NO" FROMINSTANCE="SQ_STG_ORDERS" FROMINSTANCETYPE="Source Qualifier" TOFIELD="STATUS"        TOINSTANCE="EXP_BUSINESS_RULES" TOINSTANCETYPE="Expression"/>

        <CONNECTOR FROMFIELD="ORDER_ID"          FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="ORDER_ID"          TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>
        <CONNECTOR FROMFIELD="CUSTOMER_NAME_CLEAN" FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="CUSTOMER_NAME_CLEAN" TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>
        <CONNECTOR FROMFIELD="ORDER_AMOUNT"      FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="ORDER_AMOUNT"      TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>
        <CONNECTOR FROMFIELD="TAX_AMOUNT"        FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="TAX_AMOUNT"        TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>
        <CONNECTOR FROMFIELD="ORDER_YEAR_MONTH"  FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="ORDER_YEAR_MONTH"  TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>
        <CONNECTOR FROMFIELD="STATUS_DESC"       FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="STATUS_DESC"       TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>
        <CONNECTOR FROMFIELD="IS_HIGH_VALUE"     FROMMAPPING="NO" FROMINSTANCE="EXP_BUSINESS_RULES" FROMINSTANCETYPE="Expression" TOFIELD="IS_HIGH_VALUE"     TOINSTANCE="FIL_VALID_ORDERS" TOINSTANCETYPE="Filter"/>

        <CONNECTOR FROMFIELD="ORDER_ID"          FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="ORDER_KEY"          TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>
        <CONNECTOR FROMFIELD="CUSTOMER_NAME_CLEAN" FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="CUSTOMER_NAME_CLEAN" TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>
        <CONNECTOR FROMFIELD="ORDER_AMOUNT"      FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="ORDER_AMOUNT"      TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>
        <CONNECTOR FROMFIELD="TAX_AMOUNT"        FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="TAX_AMOUNT"        TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>
        <CONNECTOR FROMFIELD="ORDER_YEAR_MONTH"  FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="ORDER_YEAR_MONTH"  TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>
        <CONNECTOR FROMFIELD="STATUS_DESC"       FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="STATUS_DESC"       TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>
        <CONNECTOR FROMFIELD="IS_HIGH_VALUE"     FROMMAPPING="NO" FROMINSTANCE="FIL_VALID_ORDERS" FROMINSTANCETYPE="Filter" TOFIELD="IS_HIGH_VALUE"     TOINSTANCE="FACT_ORDERS" TOINSTANCETYPE="Target Definition"/>

      </MAPPING>
    </FOLDER>
  </REPOSITORY>
</POWERMART>
